---
hip: 1270
title: Logical Confidential Zones (L-CZ) with Pairwise Zero-Detect Authentication for Hedera Single-Network Privacy
author: Caleb 
working-group: Sophia, Eunice, Justin
requested-by: J1729Labs
type: Standards Track
category: Application
status: Last Call
last-call-date-time: 2025-10-27T07:00:00Z
discussions-to: https://github.com/hiero-ledger/hiero-improvement-proposals/pull/1270
needs-hiero-approval: No
needs-hedera-review: No
created: 2025-08-20
updated: 2025-10-13
--------

# Simple Summary

L-CZ defines a privacy-preserving pattern, reference components, and interoperable APIs that let ecosystem builders create **confidential “zones”** inside a single Hedera network. Each zone offers scoped membership, encrypted data exchange, auditable anchoring, and policy-based access control—without requiring L1 protocol changes or separate sidechains. This HIP further extends membership authentication with a **Pairwise Zero-Detect Authentication scheme**, allowing members to prove valid membership through zero-detection verification without disclosing sensitive identity information.

# Abstract

This HIP standardizes Logical Confidential Zones (L-CZ) on Hedera. An L-CZ is a logical partition for sensitive workflows (e.g., healthcare data sharing, inter-bank settlement) where participants exchange encrypted payloads and verifiable anchors via Hashgraph Consensus Service (HCS) topics and optional Hedera Token Service (HTS) membership gating. The specification defines:

* A canonical **Zone Model** (identity, policy, membership, keying, audit, lifecycle);
* **On-ledger anchors** for ordering and integrity;
* **Off-ledger encrypted payload exchange**, with standardized metadata for discovery and compliance;
* **APIs and events** for zone lifecycle (create, join, rotate, revoke, close) and for verifiable audits;
* **Inter-zone bridging** patterns that preserve confidentiality while enabling selective transparency;
* **Pairwise Zero-Detect Authentication** as a membership verification mechanism.

# Motivation

Many regulated workflows require confidentiality but also need the properties of a public, highly available ledger for ordering, anchoring, and auditability. Today, builders either (a) fragment across private sidechains/consortia, or (b) push only hashes on-chain while handling everything else off-chain ad-hoc. This results in **poor interoperability, brittle security postures, and fragmented compliance controls**.

L-CZ addresses these gaps by standardizing:

* A portable **zone abstraction** over a single network;
* Uniform **membership & policy controls**;
* **Encrypted data exchange** with verifiable sequencing;
* **Auditable anchors** and repeatable compliance processes; and
* **Pairwise Zero-Detect Authentication**, which ensures members can prove membership by passing a zero-detection verification test rather than exposing keys or attributes.

Representative use cases include patient-centric healthcare data exchange and confidential inter-bank settlement.

# Specification

## 1. Terminology

* **Zone (L-CZ)**: A logical partition identified by a `zoneId`, with its own policy, membership, keys, and audit context.
* **Zone Operator**: Entity that creates the zone, publishes policy, manages member onboarding/offboarding, and key lifecycle.
* **Zone Member**: An entity admitted under the zone policy; holds valid zone membership credential(s).
* **Zone Anchor**: A ledger record (HCS message) that commits to an encrypted payload’s integrity, sequence, and minimal metadata.
* **Zone Registry**: A discovery map from `zoneId` to policy, public parameters, and event streams.
* **Pairwise Zero-Detect Proof (ZDP)**: A verification artifact generated by a member that demonstrates valid zone membership through a zero-detection protocol without revealing the underlying credential.

## 2. Components

### 2.1 Zone Registry (Contract or Off-chain Service)

Minimal interface:

* `createZone(policyURI, policyHash, operatorPubKey, params) -> zoneId`
* `updatePolicy(zoneId, policyURI, policyHash)`
* `publishEvent(zoneId, eventType, eventRef)` (e.g., key rotations)

The registry MUST emit events for discoverability and MUST NOT include sensitive material.

### 2.2 Membership & Admission

Admission MAY be enforced by:

* **HTS token gating**: possession of a non-transferable membership token or KYC-gated NFT/FT;
* **Signed allowlists** anchored via HCS;
* **External IAM** with verifiable credentials (e.g., OIDC/JWT or AnonCreds);
* **Pairwise Zero-Detect Authentication**: Members generate zero-detect proofs with the Zone Operator. Each proof demonstrates valid membership and compliance without exposing identity attributes. Zero-detect protocols ensure that invalid members are detected while valid members reveal nothing sensitive.

Revocation MUST be observable via a zone event and SHOULD be reflected in gating mechanisms (e.g., burn or freeze of membership token).

### 2.3 Key Management

Zones MUST specify suites for:

* **Transport/Envelope**: e.g., X25519 or ECDH for key agreement, with AEAD (AES-GCM or ChaCha20-Poly1305) for payloads;
* **Signature/Non-repudiation**: Ed25519 or ECDSA for message origin;
* **Rotation & Compromise Policy**: time- or event-based rotations; mandatory rekey after compromise events.

### 2.4 Anchoring and Payload Flow

* **Encrypted Payloads** are exchanged off-ledger (e.g., secure messaging, object storage) and include minimal, non-sensitive headers.
* For each payload, submit an **Anchor** to the zone’s HCS topic containing: `payloadDigest`, `payloadLength`, `contentType`, `encryptionSuite`, `sender`, `nonce`, and optional `complianceTags`.
* Anchors MUST be strictly ordered by Hashgraph consensus; consumers derive a verifiable history.

### 2.5 Audit & Compliance

Zones MUST define:

* **Retention windows** for anchors and payloads;
* **Audit requests**: `requestAudit(zoneId, scope, requesterProof) -> auditTicket` published as events; and
* **Selective disclosure**: cryptographic proofs (e.g., disclosing specific fields or timestamps) without revealing full payloads.

Zero-detect proofs can be partially disclosed to auditors, providing assurance of valid membership without revealing full credentials.

### 2.6 Inter-zone and Cross-org Patterns

* **Hierarchical zones**: child zones inherit policy with stricter overrides; anchors reference parent `zoneId`.
* **Bridged disclosure**: export redacted proof objects to another zone; include cross-zone references in anchors.

## 3. APIs (normative)

**Join Zone with Zero-Detect Proof**

```json
POST /zones/{zoneId}/members
{
  "memberId": "did:hedera:...",
  "zeroDetectProof": {
    "ciphertexts": ["0x...","0x..."],
    "verification": "0x...",
    "nonce": "0x..."
  }
}
```

The Operator verifies the zero-detect proof against the zone policy. Successful verification results in membership acceptance.

---

# Rationale

Integrating Pairwise Zero-Detect Authentication into L-CZ strengthens privacy guarantees:

* **Privacy**: Members prove eligibility without disclosing identity or credential data.
* **Trust**: Zone Operators verify compliance via zero-detection proofs.
* **Auditability**: Proofs are exportable for selective disclosure in regulatory audits.
* **Efficiency**: Verification ensures invalid members are caught (zero-detect) while minimizing sensitive data exposure.

# Backwards Compatibility

No breaking changes to Hedera nodes or services. L-CZ with zero-detect proofs is additive at the application layer.

# Security Considerations

* Zero-detect proofs must be designed to resist replay, collusion, and forgery.
* Pairwise protocols should include fresh nonces and Operator-side verification.
* Key compromise policies remain essential.
* Anchors must avoid embedding raw proofs; only digests or references permitted.

# Privacy & Compliance Considerations

* Zero-detect proofs prevent sensitive data leakage during membership checks.
* Selective disclosure mechanisms ensure auditors get necessary assurances without broad data exposure.

# Economic & Operational Considerations

* Verification of zero-detect proofs incurs computation overhead; SDKs MUST optimize proof evaluation.
* Anchors remain lightweight, so network fees are predictable.

# Open Issues

* Standardization of zero-detect proof formats across different industries.
* Performance benchmarking and optimization of zero-detect verification at scale.
* **Post-Quantum Cryptography (PQC) adaptation**: research is needed to transition zero-detect membership proofs to PQC-safe primitives to future-proof against quantum attacks.

# References

* HIP-1: HIP Process.
* Pairwise Zero-Detect Authentication (J1729Labs, 2025).
* Hedera docs for HCS and HTS usage.

# Copyright

Copyright 2025 The HIP authors.

Licensed under the Apache License, Version 2.0.
